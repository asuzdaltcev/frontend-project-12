# Тестирование управления каналами

## Обзор функциональности

Реализована полная система управления каналами с возможностями:
- Переключение между каналами
- Добавление новых каналов
- Переименование каналов
- Удаление каналов (с подтверждением)
- Выпадающие меню управления
- Валидация форм с помощью Formik и Yup

## Компоненты

### 1. AddChannelModal
- **Файл**: `frontend/src/components/AddChannelModal.jsx`
- **Функции**: Создание нового канала
- **Валидация**: 
  - Минимум 3 символа
  - Максимум 20 символов
  - Уникальность имени
  - Обязательное поле

### 2. RenameChannelModal
- **Файл**: `frontend/src/components/RenameChannelModal.jsx`
- **Функции**: Переименование существующего канала
- **Валидация**: Аналогично AddChannelModal

### 3. RemoveChannelModal
- **Файл**: `frontend/src/components/RemoveChannelModal.jsx`
- **Функции**: Удаление канала с подтверждением
- **Особенности**: Удаляет все сообщения канала

### 4. ChannelDropdown
- **Файл**: `frontend/src/components/ChannelDropdown.jsx`
- **Функции**: Выпадающее меню с кнопками управления
- **Кнопки**: Переименовать, Удалить

### 5. ChannelList (обновленный)
- **Файл**: `frontend/src/components/ChannelList.jsx`
- **Новые функции**: Кнопка добавления канала, выпадающие меню

## Сценарии тестирования

### 1. Переключение между каналами
**Шаги:**
1. Войти в приложение
2. Нажать на разные каналы в списке
3. Проверить, что чат обновляется

**Ожидаемый результат:**
- Активный канал подсвечивается
- Сообщения загружаются для выбранного канала
- URL обновляется с ID канала

### 2. Добавление нового канала
**Шаги:**
1. Нажать кнопку "+" рядом с "Каналы"
2. Ввести валидное имя канала (3-20 символов)
3. Нажать "Добавить" или Enter

**Ожидаемый результат:**
- Модальное окно закрывается
- Новый канал появляется в списке
- Автоматически переключаемся на новый канал
- Форма сбрасывается

### 3. Валидация при добавлении канала
**Тесты:**
- **Короткое имя**: Ввести 1-2 символа → ошибка "Минимум 3 символа"
- **Длинное имя**: Ввести >20 символов → ошибка "Максимум 20 символов"
- **Дубликат**: Ввести существующее имя → ошибка "Канал с таким именем уже существует"
- **Пустое поле**: Оставить пустым → ошибка "Обязательное поле"

### 4. Переименование канала
**Шаги:**
1. Навести курсор на канал
2. Нажать на кнопку выпадающего меню
3. Выбрать "Переименовать"
4. Ввести новое имя
5. Нажать "Переименовать" или Enter

**Ожидаемый результат:**
- Имя канала обновляется в списке
- Модальное окно закрывается
- Валидация работает аналогично добавлению

### 5. Удаление канала
**Шаги:**
1. Навести курсор на канал
2. Нажать на кнопку выпадающего меню
3. Выбрать "Удалить"
4. Подтвердить удаление

**Ожидаемый результат:**
- Канал удаляется из списка
- Все сообщения канала удаляются
- Если удалялся активный канал, переключаемся на первый доступный
- Модальное окно закрывается

### 6. Отмена операций
**Тесты:**
- Нажать "Отмена" в модальных окнах
- Нажать "X" в заголовке модального окна
- Нажать Escape

**Ожидаемый результат:**
- Модальное окно закрывается
- Изменения не применяются
- Форма сбрасывается

### 7. Отправка формы по Enter
**Тесты:**
- Ввести валидное имя в поле ввода
- Нажать Enter
- Проверить, что форма отправляется

### 8. Блокировка кнопок во время запросов
**Тесты:**
- Начать операцию (добавление/переименование/удаление)
- Проверить, что кнопки блокируются
- Проверить текст кнопок (например, "Добавление...")

### 9. Адаптивность интерфейса
**Тесты:**
- Длинные имена каналов
- Большое количество каналов
- Мобильные устройства
- Разные размеры экрана

### 10. WebSocket интеграция
**Тесты:**
- Добавление канала при активном WebSocket
- Переименование канала при активном WebSocket
- Удаление канала при активном WebSocket
- Проверка синхронизации между вкладками

## Тестирование в разных браузерах

### Chrome/Chromium
- Все функции работают корректно
- Валидация форм работает
- WebSocket соединение стабильно

### Firefox
- Проверить совместимость с WebSocket
- Проверить работу модальных окон
- Проверить CSS стили

### Safari
- Проверить работу WebSocket
- Проверить модальные окна
- Проверить валидацию форм

### Edge
- Проверить общую совместимость
- Проверить WebSocket соединение

## Тестирование на мобильных устройствах

### iOS Safari
- Проверить работу модальных окон
- Проверить адаптивность интерфейса
- Проверить работу выпадающих меню

### Android Chrome
- Проверить все функции управления каналами
- Проверить адаптивность
- Проверить WebSocket соединение

## Тестирование производительности

### Большое количество каналов
- Создать 50+ каналов
- Проверить производительность списка
- Проверить работу выпадающих меней

### Большое количество сообщений
- Добавить 1000+ сообщений в канал
- Проверить производительность переключения
- Проверить удаление канала с большим количеством сообщений

## Тестирование ошибок

### Сетевые ошибки
- Отключить интернет во время операций
- Проверить обработку ошибок
- Проверить восстановление после восстановления соединения

### Ошибки сервера
- Симулировать 500 ошибки
- Проверить отображение ошибок пользователю
- Проверить возможность повтора операций

## Автоматизированное тестирование

### Unit тесты
```javascript
// Пример теста для валидации
describe('Channel validation', () => {
  test('should validate minimum length', () => {
    const result = validationSchema.validate({ name: 'ab' });
    expect(result.error).toBeTruthy();
  });
  
  test('should validate maximum length', () => {
    const result = validationSchema.validate({ name: 'a'.repeat(21) });
    expect(result.error).toBeTruthy();
  });
});
```

### Integration тесты
```javascript
// Пример теста для добавления канала
test('should add new channel', async () => {
  const { getByText, getByPlaceholderText } = render(<AddChannelModal />);
  
  fireEvent.change(getByPlaceholderText('Введите имя канала'), {
    target: { value: 'Test Channel' }
  });
  
  fireEvent.click(getByText('Добавить'));
  
  await waitFor(() => {
    expect(mockDispatch).toHaveBeenCalledWith(addChannel('Test Channel'));
  });
});
```

## Чек-лист тестирования

- [ ] Переключение между каналами работает
- [ ] Добавление канала работает
- [ ] Валидация форм работает корректно
- [ ] Переименование канала работает
- [ ] Удаление канала работает с подтверждением
- [ ] Выпадающие меню отображаются корректно
- [ ] Отправка формы по Enter работает
- [ ] Кнопки блокируются во время запросов
- [ ] Интерфейс адаптивен
- [ ] WebSocket интеграция работает
- [ ] Обработка ошибок работает
- [ ] Производительность приемлема

## Известные ограничения

1. **Удаление каналов**: Удаляются только вновь созданные каналы (проверка `removable` поля)
2. **WebSocket**: При отключении WebSocket используется HTTP fallback
3. **Валидация**: Проверка уникальности имен происходит на клиенте

## Рекомендации по улучшению

1. Добавить подтверждение при переименовании канала
2. Добавить поиск по каналам
3. Добавить категории каналов
4. Добавить настройки приватности каналов
5. Добавить статистику каналов 